{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nvar checkUser = function checkUser() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    userData = _useState2[0],\n    setUserData = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    time = _useState4[0],\n    setTime = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userLogin = _useState6[0],\n    setUserLogin = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isLoading = _useState8[0],\n    setIsLoading = _useState8[1];\n  var _useState9 = useState(null),\n    _useState10 = _slicedToArray(_useState9, 2),\n    error = _useState10[0],\n    setError = _useState10[1];\n  var getTimeOfDay = function getTimeOfDay() {\n    var now = new Date();\n    var hour = now.getHours();\n    if (hour >= 0 && hour < 12) {\n      return '☀️ ';\n    } else if (hour >= 12 && hour < 17) {\n      return '🌤️ ';\n    } else {\n      return '🌙 ';\n    }\n  };\n  var checkExistingUser = function () {\n    var _ref = _asyncToGenerator(function* () {\n      var id = yield AsyncStorage.getItem(\"id\");\n      var token = yield AsyncStorage.getItem(\"token\");\n      var userId = JSON.parse(id);\n      var accessToken = JSON.parse(token);\n      var greeting = getTimeOfDay();\n      setTime(greeting);\n      try {\n        if (userId !== null) {\n          try {\n            var response = yield axios.get('https://nativetravelappbackend-production.up.railway.app/api/users', {\n              headers: {\n                Authorization: `Bearer ${accessToken}`\n              }\n            });\n            if (response.status === 200) {\n              setUserData(response.data);\n              if (userId === response.data._id) {\n                setUserLogin(true);\n                setUserData(response.data);\n              } else {\n                Alert.alert(\"Incorrect Account \", \"Please login with your own account \", [{\n                  text: \"Cancel\",\n                  onPress: function onPress() {}\n                }, {\n                  text: \"Continue\",\n                  onPress: function onPress() {\n                    return navigation.navigate('AuthTop');\n                  }\n                }, {\n                  defaultIndex: 1\n                }]);\n              }\n            }\n          } catch (error) {\n            console.log(\"Failed to get products\", error);\n          }\n        } else {}\n      } catch (error) {\n        console.log(\"Error retrieving the data:\", error);\n      }\n    });\n    return function checkExistingUser() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    checkExistingUser();\n  }, []);\n  return {\n    userLogin: userLogin,\n    userData: userData,\n    isLoading: isLoading,\n    time: time\n  };\n};\nexport default checkUser;","map":{"version":3,"names":["useState","useEffect","axios","AsyncStorage","checkUser","_useState","_useState2","_slicedToArray","userData","setUserData","_useState3","_useState4","time","setTime","_useState5","_useState6","userLogin","setUserLogin","_useState7","_useState8","isLoading","setIsLoading","_useState9","_useState10","error","setError","getTimeOfDay","now","Date","hour","getHours","checkExistingUser","_ref","_asyncToGenerator","id","getItem","token","userId","JSON","parse","accessToken","greeting","response","get","headers","Authorization","status","data","_id","Alert","alert","text","onPress","navigation","navigate","defaultIndex","console","log","apply","arguments"],"sources":["C:/Users/nishchal/Documents/github/native_travel_app_frontend/hook/checkUser.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst checkUser = () => {\n    const [userData, setUserData] = useState(null);\n    const [time, setTime] = useState(null);\n    const [userLogin, setUserLogin] = useState(false);\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState(null)\n\n\n    const getTimeOfDay = () => {\n      const now = new Date();\n      const hour = now.getHours();\n  \n      if (hour >= 0 && hour < 12) {\n          return '☀️ ';\n      } else if (hour >= 12 && hour < 17) {\n          return '🌤️ ';\n      } else {\n          return '🌙 ';\n      }\n  }\n\n    const checkExistingUser = async () => {\n        const id = await AsyncStorage.getItem(\"id\");\n        const token = await AsyncStorage.getItem(\"token\");\n        const userId = JSON.parse(id);\n        const accessToken = JSON.parse(token);\n        const greeting = getTimeOfDay();\n\n        setTime(greeting)\n\n        try {\n          if (userId !== null) {\n    \n            try {\n              const response = await axios.get(\n                'https://nativetravelappbackend-production.up.railway.app/api/users',\n                {\n                  headers: {\n                    Authorization: `Bearer ${accessToken}`,\n                  },\n                }\n              );\n              \n              if(response.status === 200){\n                setUserData(response.data)\n                if(userId === response.data._id){\n                  setUserLogin(true);\n                  setUserData(response.data)\n                }else{\n                  Alert.alert(\"Incorrect Account \", \"Please login with your own account \", [\n                    {\n                      text: \"Cancel\",\n                      onPress: () => {},\n                    },\n                    {\n                      text: \"Continue\",\n                      onPress: () => navigation.navigate('AuthTop'),\n                    },\n                    { defaultIndex: 1 },\n                  ]);\n                }\n    \n              }\n            } catch (error) {\n              console.log(\"Failed to get products\", error);\n            }\n          } else {\n          }\n        } catch (error) {\n          console.log(\"Error retrieving the data:\", error);\n        }\n      };\n\n    useEffect(() => {\n        checkExistingUser();\n    }, [])\n\n\n    return {userLogin,userData ,isLoading, time}\n}\n\nexport default checkUser"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}